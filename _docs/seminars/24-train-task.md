---
title: 24 — Тренировочное задание по обработке корпуса
permalink: /24/
---

# План этого занятия
* Пакетная обработка файлов
* Создание каталогов 
* Связывание данных
* Работа с Git

Для работы нам потребуется [архив с файлами древнерусского корпуса](/content/mid_rus_conll.zip) в формате CONLL-U(D). CONLL-формат -- это почти то же самое, что знакомый нам TSV, то есть по сути табличка с табуляциями-разделителями.

Для удобства ручной обработки много мелких исходных файлов корпуса были слиты вместе. Теперь нужно снова их разделить и восстановить первоначальную структуру файлов-каталогов. 

В каждом большом файле, которые у нас есть, имеется строка вида `# newdoc id = texts/afz3/AFZ_3_2_030` Она означает, что всё, что ниже этой строки до следующей аналогичной, должно быть выделено в отдельный файл, который называется `AFZ_3_2_030.txt`, а файл этот должен лежать в директории `afz3`, которая в свою очередь должна быть вложена в директорию `texts`.

## Первая часть задания: файлы и папки

Таким образом, нужно написать программу, которая:

1. По очереди открывает большие файлы,
2. автоматически создает директории с нужными названиями,
3. кладёт в них маленькие файлы (появившися в результате разрезания больших).

## Вторая часть задания: Git

После того, как у вас получился код и его результат, нужно выложить их на гитхаб (на самом деле, код правильно писать уже в локальном репозитории и коммитить изменения в нём нужно тоже в процессе, но так как это дело непривычное, можно разделить работу на два этапа).

Для этого нужно [создать новый](https://github.com/new) **публичный** репозиторий на Gitub, склонировать его на локальный компьютер, с помощью файлового менеджера положить в него код и папку `texts` с получившимися маленькими файлами, сделать `git add`, `git commit` и `git push`, убедиться в том, что результаты работы видны в веб-интерфейсе гитхаба.

Дело в том, что в результате получится куча файлов и каталогов. Загрузить всё это богатство через веб-интерфейс, как вы, возможно, привыкли, может не получиться. Нужно воспользоваться командной строкой.

Грузить исходные большие файлы в репозиторий не нужно. Некоторые из них настолько большие, что гитхаб может запретить их загрузку. Поэтому убедитесь, что их нет в репозитории. А лучше воспользоваться запретом на индексацию папки, где лежат большие файлы. Для этого есть `.gitignore`, [см. подробнее](https://git-scm.com/docs/gitignore).

## Третья часть задания: связывание данных

Заниматься этой частью задания имеет смысл только если вы справились с первой и второй.

Сейчас в файлах с разметкой древнерусского корпуса нет лемм, есть только грамматическая информация и нормализованное написание словоформы. Но информацию о лемме можно добавить. Вы же понимаете, как это полезно.

[Здесь лежит словарь древнерусских глаголов](/content/mid_rus_verbs.txt), устроенный как тот же TSV: это таблица с табуляцией-разделителем. Во второй колонке там находится словоформа, а в третьей - соответствующая ей лемма древнерусского глагола.

Таким образом, нужно написать программу, которая:

1. Загружает словарь в виде питоновского словаря вида "словоформа: лемма",
2. Обходит все маленькие файлы из первого задания,
3. Добавляет к CONLL новую колонку (она будет последней),
4. "Просматривает" все словоформы на наличие словоформ из словаря.
5. В случае "попадания" добавляет в новую колонку информацию о лемме; если словоформа в словаре не нашлась, тогда поле остаётся пустым (но табуляция перед этим пустым значением всё равно должна быть!)

Если результат получился, его тоже нужно закоммитить и запушить в Git-репозиторий.
